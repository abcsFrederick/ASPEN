<!DOCTYPE html><html class=writer-html5 lang=en> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=author content=CCBR><link rel="shortcut icon" href=../img/favicon.ico><title>ASPEN Output - ASPEN</title><link rel=stylesheet href=../css/theme.css><link rel=stylesheet href=../css/theme_extra.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css><link href=../css/custom.css rel=stylesheet><link href=../css/version-select.css rel=stylesheet><script>
        // Current page data
        var mkdocs_page_name = "ASPEN Output";
        var mkdocs_page_input_path = "outputs.md";
        var mkdocs_page_url = null;
      </script><!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]--><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js></script><script>hljs.highlightAll();</script></head> <body class=wy-body-for-nav role=document> <div class=wy-grid-for-nav> <nav data-toggle=wy-nav-shift class="wy-nav-side stickynav"> <div class=wy-side-scroll> <div class=wy-side-nav-search> <a href=.. class="icon icon-home"> ASPEN </a><div role=search> <form id=rtd-search-form class=wy-form action=../search.html method=get> <input type=text name=q placeholder="Search docs" aria-label="Search docs" title="Type search term here"> </form> </div> </div> <div class="wy-menu wy-menu-vertical" data-spy=affix role=navigation aria-label="Navigation menu"> <ul> <li class=toctree-l1><a class="reference internal" href=..>Background</a> </li> </ul> <ul> <li class=toctree-l1><a href=../introduction/ class="reference internal">Introduction to ATAC-seq</a> </li> </ul> <ul> <li class=toctree-l1><a href=../overview/ class="reference internal">Overview of ASPEN</a> </li> </ul> <ul> <li class=toctree-l1><a href=../deployment/ class="reference internal">Running ASPEN</a> </li> </ul> <ul class=current> <li class="toctree-l1 current"><a class="reference internal current" href=#>ASPEN Output</a> <ul class=current> <li class=toctree-l2><a class="reference internal" href=#workdir>ðŸ“‚ Workdir</a> </li> <li class=toctree-l2><a class="reference internal" href=#results-folder>ðŸ“Š results folder</a> <ul> <li class=toctree-l3><a class="reference internal" href=#peak-annotation-folder>Peak Annotation folder</a> </li> <li class=toctree-l3><a class="reference internal" href=#macs2-output-folder>MACS2 output folder</a> </li> <li class=toctree-l3><a class="reference internal" href=#genrich-output-folder>Genrich output folder</a> </li> </ul> </li> <li class=toctree-l2><a class="reference internal" href=#logs-folder>logs folder</a> </li> </ul> </li> </ul> <ul> <li class=toctree-l1><a href=../limitations/ class="reference internal">Limitations of ASPEN</a> </li> </ul> <ul> <li class=toctree-l1><a href=../communications/ class="reference internal">Communications</a> </li> </ul> <ul> <li class=toctree-l1><a href=../changelog/ class="reference internal">Change Log</a> </li> </ul> <ul> <li class=toctree-l1><a href=../contributing/ class="reference internal">Contributing to ASPEN</a> </li> </ul> </div> </div> </nav> <section data-toggle=wy-nav-shift class=wy-nav-content-wrap> <nav class=wy-nav-top role=navigation aria-label="Mobile navigation menu"> <i data-toggle=wy-nav-top class="fa fa-bars"></i> <a href=..>ASPEN</a> </nav> <div class=wy-nav-content> <div class=rst-content><div role=navigation aria-label="breadcrumbs navigation"> <ul class=wy-breadcrumbs> <li><a href=.. class="icon icon-home" aria-label=Docs></a></li> <li class="breadcrumb-item active">ASPEN Output</li> <li class=wy-breadcrumbs-aside> <a href=https://github.com/CCBR/ASPEN/edit/main/docs/outputs.md>Edit on CCBR/ASPEN</a> </li> </ul> <hr> </div> <div role=main class=document itemscope=itemscope itemtype=http://schema.org/Article> <div class=section itemprop=articleBody> <h1 id=aspen-outputs>ðŸš€ ASPEN Outputs<a class=headerlink href=#aspen-outputs title="Permanent link">&para;</a></h1> <h2 id=workdir>ðŸ“‚ Workdir<a class=headerlink href=#workdir title="Permanent link">&para;</a></h2> <p>The workdir which is supplied as <code>-w</code> while running aspen <code>init</code>, <code>dryrun</code> and <code>run</code> commands will contain the following files:</p> <div class=highlight><pre><span></span><code>WORKDIR
â”œâ”€â”€<span class=w> </span>cluster.json
â”œâ”€â”€<span class=w> </span>config.yaml
â”œâ”€â”€<span class=w> </span>contrasts.tsv
â”œâ”€â”€<span class=w> </span>dryrun_git_commit.txt
â”œâ”€â”€<span class=w> </span>dryrun.log
â”œâ”€â”€<span class=w> </span>fastqs
â”œâ”€â”€<span class=w> </span>logs
â”œâ”€â”€<span class=w> </span>results
â”œâ”€â”€<span class=w> </span>run_git_commit.txt
â”œâ”€â”€<span class=w> </span>runinfo.yaml
â”œâ”€â”€<span class=w> </span>runslurm_snakemake_report.html
â”œâ”€â”€<span class=w> </span>sampleinfo.txt
â”œâ”€â”€<span class=w> </span>samples.tsv
â”œâ”€â”€<span class=w> </span>scripts
â”œâ”€â”€<span class=w> </span>slurm-XXXXXXX.out
â”œâ”€â”€<span class=w> </span>snakemake.log
â”œâ”€â”€<span class=w> </span>snakemake.log.jobby
â”œâ”€â”€<span class=w> </span>snakemake.log.jobby.short
â”œâ”€â”€<span class=w> </span>snakemake.stats
â”œâ”€â”€<span class=w> </span>submit_script.sbatch
â””â”€â”€<span class=w> </span>tools.yaml
</code></pre></div> <p>Here are more details about these files:</p> <table> <thead> <tr> <th><strong>File</strong></th> <th><strong>File Type</strong></th> <th><strong>Mode (<code>-m</code>) When This File is Created/Overwritten</strong></th> <th><strong>Description</strong></th> </tr> </thead> <tbody> <tr> <td><code>cluster.json</code></td> <td>JSON</td> <td>init</td> <td>Defines cluster resources per snakemake rule; this file can be edited to override default computate resource allocations per snakemake rule</td> </tr> <tr> <td><code>config.yaml</code></td> <td>YAML</td> <td>init; can be edited later</td> <td>Configurable parameters for this specific run</td> </tr> <tr> <td><code>contrasts.tsv</code></td> <td>TSV</td> <td>Needs to be added in after init</td> <td>List of contrasts to run, one per line; has no header</td> </tr> <tr> <td><code>dryrun_git_commit.txt</code></td> <td>TXT</td> <td>dryrun</td> <td>The git commit hash of the version of ASPEN used at dryrun</td> </tr> <tr> <td><code>dryrun.log</code></td> <td>TXT</td> <td>dryrun</td> <td>Log from <code>-m=dryrun</code></td> </tr> <tr> <td><code>fastqs</code></td> <td>FOLDER</td> <td>dryrun</td> <td>Folder containing symlinks to raw data</td> </tr> <tr> <td><code>logs</code></td> <td>FOLDER</td> <td>dryrun</td> <td>Folder containing all logs including Slurm <code>.out</code> and <code>.err</code> files. Also contains older timestamped <code>runinfo.yaml</code> and <code>snakemake.stats</code> files.</td> </tr> <tr> <td><code>results</code></td> <td>FOLDER</td> <td>Created at dryrun but populated during run</td> <td>Main outputs folder</td> </tr> <tr> <td><code>runinfo.yaml</code></td> <td>YAML</td> <td>After completion of run</td> <td>Metadata about the run executor, etc.</td> </tr> <tr> <td><code>runslurm_snakemake_report.html</code></td> <td>HTML</td> <td>After completion of run</td> <td>HTML report including DAG and resource utilization</td> </tr> <tr> <td><code>sampleinfo.txt</code></td> <td>TXT</td> <td>dryrun, run</td> <td>Tab-delimited mappings between <code>replicateNames</code> and <code>sampleNames</code></td> </tr> <tr> <td><code>samples.tsv</code></td> <td>TSV</td> <td>init; can be edited later</td> <td>Tab-delimited manifest with <code>replicateName</code>, <code>sampleName</code>, <code>path_to_R1_fastq</code>, <code>path_to_R2_fastq</code>. This file has a header.</td> </tr> <tr> <td><code>scripts</code></td> <td>FOLDER</td> <td>init</td> <td>Folder keeps local copy of scripts called by various rules</td> </tr> <tr> <td><code>run_git_commit.txt</code></td> <td>TXT</td> <td>run</td> <td>The git commit hash of the version of ASPEN used at run</td> </tr> <tr> <td><code>slurm-XXXXXXX.out</code></td> <td>TXT</td> <td>run</td> <td>Slurm <code>.out</code> file for the master job</td> </tr> <tr> <td><code>snakemake.log</code></td> <td>TXT</td> <td>run</td> <td>Snakemake <code>.log</code> file for the master job; older copies timestamped and moved into <code>logs</code> folder</td> </tr> <tr> <td><code>snakemake.stats</code></td> <td>JSON</td> <td>run</td> <td>per rule runtime stats</td> </tr> <tr> <td><code>submit_script.sbatch</code></td> <td>TXT</td> <td>run</td> <td>Slurm script to kickstart the main Snakemake job</td> </tr> <tr> <td><code>tools.yaml</code></td> <td>YAML</td> <td>run</td> <td>YAML containing the version of tools used in the pipeline (obsolete; was used to load specific module versions prior to moving over to Docker/Singularity containers)</td> </tr> </tbody> </table> <h2 id=results-folder>ðŸ“Š <code>results</code> folder<a class=headerlink href=#results-folder title="Permanent link">&para;</a></h2> <p>The results directory contains the actual output files. Below are the folders that you may find within it.</p> <div class=highlight><pre><span></span><code>WORKDIR
â”œâ”€â”€<span class=w> </span>results
<span class=w>    </span>â”œâ”€â”€<span class=w> </span>alignment
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>dedupBam
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>filteredBam
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>qsortedBam
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â””â”€â”€<span class=w> </span>tagAlign
<span class=w>    </span>â”œâ”€â”€<span class=w> </span>peaks
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>genrich
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>DiffATAC
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>reads
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â””â”€â”€<span class=w> </span>tn5sites
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â””â”€â”€<span class=w> </span>fixed_width
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â””â”€â”€<span class=w> </span>macs2
<span class=w>    </span>â”‚<span class=w>Â Â      </span>â”œâ”€â”€<span class=w> </span>DiffATAC
<span class=w>    </span>â”‚<span class=w>Â Â      </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>reads
<span class=w>    </span>â”‚<span class=w>Â Â      </span>â”‚<span class=w>Â Â  </span>â””â”€â”€<span class=w> </span>tn5sites
<span class=w>    </span>â”‚<span class=w>Â Â      </span>â””â”€â”€<span class=w> </span>fixed_width
<span class=w>    </span>â”œâ”€â”€<span class=w> </span>QC
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>fastqc
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>fld
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>FQscreen
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>frip
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>multiqc_data
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>peak_annotation
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>preseq
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â””â”€â”€<span class=w> </span>tss
<span class=w>    </span>â”œâ”€â”€<span class=w> </span>spikein
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>&lt;sample_1&gt;
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>&lt;sample_2&gt;
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>&lt;sample_3&gt;
<span class=w>    </span>â”‚<span class=w>   </span>â”‚<span class=w> </span>...
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â””â”€â”€<span class=w> </span>&lt;sample_n&gt;
<span class=w>    </span>â”œâ”€â”€<span class=w> </span>tmp
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>BL
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>genrichReads
<span class=w>    </span>â”‚<span class=w>Â Â  </span>â””â”€â”€<span class=w> </span>trim
<span class=w>    </span>â””â”€â”€<span class=w> </span>visualization
<span class=w>        </span>â”œâ”€â”€<span class=w> </span>reads_bam
<span class=w>        </span>â”œâ”€â”€<span class=w> </span>reads_bed
<span class=w>        </span>â”œâ”€â”€<span class=w> </span>reads_bigwig
<span class=w>        </span>â”œâ”€â”€<span class=w> </span>tn5sites_bam
<span class=w>        </span>â””â”€â”€<span class=w> </span>tn5sites_bigwig
</code></pre></div> <p>Content details:</p> <table> <thead> <tr> <th>Folder</th> <th>SubFolder</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>alignment</td> <td>qsortedBam</td> <td>- Query sorted Bowtie2 alignments in BAM format. <br> - Excludes unmapped and platform/vendor quality failing reads. <br> - Used for Genrich peak calling.</td> </tr> <tr> <td>alignment</td> <td>filteredBam</td> <td>- Filtered BAM files after excluding non-primary, supplementary, and MAPQ &lt;=5 alignments. <br> - Used for counting reads/tn5 nicks. <br> - Derived from <code>qsortedBam</code>.</td> </tr> <tr> <td>alignment</td> <td>dedupBam</td> <td>- Deduplicated filtered BAM files. <br> - PCR or optical duplicates marked with PicardTools and excluded. <br> - Can be used downstream with CCBR_TOBIAS pipeline. <br> - Derived from <code>filteredBam</code>.</td> </tr> <tr> <td>alignment</td> <td>tagAlign</td> <td>- <code>tagAlign.gz</code> files used for MACS2 peak calling. <br> - Derived from <code>dedupBam</code>.</td> </tr> <tr> <td>peaks</td> <td>genrich &amp; macs</td> <td>- Genrich/MACS2 peak calls (raw, consensus, fixed-width). <br> - Contains ROI files with Diff-ATAC results if <code>contrasts.tsv</code> is provided. <br> - Calculated with DESeq2 using both read counts and tn5 nicking sites in ROI.</td> </tr> <tr> <td>QC</td> <td>various</td> <td>- Flagstats. <br> - Dupmetrics. <br> - Read counts. <br> - Motif enrichments. <br> - FLD stats. <br> - Fqscreen. <br> - FRiP. <br> - ChIPSeeker results. <br> - TSS enrichments. <br> - Preseq. <br> - Homer/AME motif enrichments. <br> - MultiQC.</td> </tr> <tr> <td>QC</td> <td>peak_annotation</td> <td>detailed peak annotations described below</td> </tr> <tr> <td>spikein</td> <td>1 folder per sample</td> <td>- Per sample spike-in counts. <br> - Overall scaling factors table.</td> </tr> <tr> <td>tmp</td> <td>various</td> <td>- Can be deleted. <br> - Blacklist index. <br> - Intermediate FASTQs. <br> - Genrich output reads.</td> </tr> <tr> <td>visualization</td> <td>reads_bam</td> <td>- Tn5 nick adjusted reads in BAM format. <br> - Derived from <code>filteredBam</code>.</td> </tr> <tr> <td>visualization</td> <td>reads_bed</td> <td>- Tn5 nick adjusted reads in BED format. <br> - Derived from <code>reads_bam</code>. <br> - Can be used by ChromVar.</td> </tr> <tr> <td>visualization</td> <td>reads_bigwig</td> <td>- Tn5 nick adjusted reads in BIGWIG format. <br> - Scaled using spike-in scaling factors if present. <br> - Derived from <code>reads_bam</code>.</td> </tr> <tr> <td>visualization</td> <td>tn5sites_bam</td> <td>- Tn5 nicking sites in BAM format. <br> - Derived from <code>filteredBam</code>.</td> </tr> <tr> <td>visualization</td> <td>tn5sites_bigwig</td> <td>- Tn5 nicking sites in BIGWIG format. <br> - Scaled using spike-in scaling factors if present. <br> - Derived from <code>tn5sites_bam</code>.</td> </tr> </tbody> </table> <div class="admonition note"> <p class=admonition-title>Note</p> </div> <p>BAM files from <code>dedupBam</code> can be used for downstream footprinting analysis using <a href=https://github.com/CCBR/CCBR_Tobias>CCBR_TOBIAS</a> pipeline</p> <div class="admonition note"> <p class=admonition-title>Note</p> </div> <p><a href=https://deeptools.readthedocs.io/en/develop/content/tools/bamCompare.html>bamCompare</a> from deeptools can be run to compare BAMs from <code>dedupBam</code> for comprehensive BAM comparisons.</p> <div class="admonition note"> <p class=admonition-title>Note</p> </div> <p>BAM files from <code>dedupBam</code> can also be converted to BED format and processed with <a href=https://github.com/GreenleafLab/chromVAR>chromVAR</a> to identify variability in motif accessibility across samples and assess differentially active transcription factors from the JASPAR database.</p> <h4 id=peak-annotation-folder>Peak Annotation folder<a class=headerlink href=#peak-annotation-folder title="Permanent link">&para;</a></h4> <p>This folder will contain ChIPseeker results for:</p> <ul> <li>individual replicate <code>*.narrowPeak</code> files</li> <li><code>*.consensus.bed</code> files</li> <li><code>*.fixed_width.consensus.narrowPeak</code> files</li> </ul> <p>The <code>QC</code> folder contains the <code>multiqc_report.html</code> file which provides a comprehensive summary of the quality control metrics across all samples, including read quality, duplication rates, and other relevant statistics. This report aggregates results from various QC tools such as FastQC, FastqScreen, FLD, TSS enrichment, Peak Annotations, and others, presenting them in an easy-to-read format with interactive plots and tables. It helps in quickly identifying any issues with the sequencing data and ensures that the data quality is sufficient for downstream analysis.</p> <table> <thead> <tr> <th>File</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>*.narrowPeak.annotated.gz</code></td> <td>peak calls annotated using ChIPseeker, gzipped</td> </tr> <tr> <td><code>*.narrowPeak.annotated.distribution</code></td> <td>annotation bins : <br> - <strong>3'UTR</strong>: No. of peaks in the 3' untranslated region. <br> - <strong>5'UTR</strong>: No. of peaks in the 5' untranslated region. <br> - <strong>Distal Intergenic</strong>: No. of peaks in distal intergenic regions. <br> - <strong>Downstream (&lt;1kb)</strong>: No. of peaks annotated downstream within 1kb. <br> - <strong>Downstream (1-2kb)</strong>: No. of peaks annotated downstream between 1-2kb. <br> - <strong>Downstream (2-3kb)</strong>: No. of peaks annotated downstream between 2-3kb. <br> - <strong>Promoter (&lt;=1kb)</strong>: No. of peaks in promoters within 1kb. <br> - <strong>Promoter (1-2kb)</strong>: No. of peaks in promoters between 1-2kb. <br> - <strong>Exon</strong>: No. of peaks in exonic regions.</td> </tr> <tr> <td><code>*.narrowPeak.annotated_summary</code></td> <td>More stats on each of the above bins .. like: <br> - medianWidth <br> - medianpValue <br> - medianqValue</td> </tr> <tr> <td><code>*.narrowPeak.genelist</code></td> <td>ensemblID and gene symbols of genes with peaks in their promoter regions (including 5' UTR)</td> </tr> </tbody> </table> <h3 id=macs2-output-folder>MACS2 output folder<a class=headerlink href=#macs2-output-folder title="Permanent link">&para;</a></h3> <p>For a typical 2 sample analysis with 2 replicates each this folder should look like this:</p> <div class=highlight><pre><span></span><code>WORKDIR
â”œâ”€â”€<span class=w> </span>results
<span class=w>    </span>â”œâ”€â”€<span class=w> </span>peaks
<span class=w>        </span>â””â”€â”€<span class=w> </span>macs2
<span class=w>            </span>â”œâ”€â”€<span class=w> </span>sample1
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample1_replicate1.macs2.narrowPeak
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample1_replicate1.macs2.narrowPeak_motif_enrichment
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>ame_results.txt
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>background.fa
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>knownResults
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>knownResults.html
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>knownResults.txt
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>motifFindingParameters.txt
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>seq.autonorm.tsv
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â””â”€â”€<span class=w> </span>target.fa
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample1_replicate1.macs2.unfiltered.narrowPeak
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample1_replicate2.macs2.narrowPeak
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample1_replicate2.macs2.narrowPeak_motif_enrichment
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>ame_results.txt
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>background.fa
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>knownResults
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>knownResults.html
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>knownResults.txt
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>motifFindingParameters.txt
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>seq.autonorm.tsv
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â””â”€â”€<span class=w> </span>target.fa
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample1_replicate2.macs2.unfiltered.narrowPeak
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample1.macs2.consensus.bed
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample1.macs2.consensus.bed_motif_enrichment
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>ame_results.txt
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>background.fa
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>knownResults
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>knownResults.html
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>knownResults.txt
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>motifFindingParameters.txt
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>seq.autonorm.tsv
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â””â”€â”€<span class=w> </span>target.fa
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample1.macs2.pooled.narrowPeak
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample1.macs2.pooled_summits.bed
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â””â”€â”€<span class=w> </span>sample1.macs2.pooled.unfiltered.narrowPeak
<span class=w>            </span>â”œâ”€â”€<span class=w> </span>sample1.consensus.macs2.peakfiles
<span class=w>            </span>â”œâ”€â”€<span class=w> </span>sample1.replicate.macs2.peakfiles
<span class=w>            </span>â”œâ”€â”€<span class=w> </span>DiffATAC
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>reads
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>all_diff_atacs.html
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>all_diff_atacs.tsv
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>degs.done
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample2_vs_sample1.html
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â””â”€â”€<span class=w> </span>sample2_vs_sample1.tsv
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â””â”€â”€<span class=w> </span>tn5sites
<span class=w>            </span>â”‚<span class=w>Â Â      </span>â”œâ”€â”€<span class=w> </span>all_diff_atacs.html
<span class=w>            </span>â”‚<span class=w>Â Â      </span>â”œâ”€â”€<span class=w> </span>all_diff_atacs.tsv
<span class=w>            </span>â”‚<span class=w>Â Â      </span>â”œâ”€â”€<span class=w> </span>degs.done
<span class=w>            </span>â”‚<span class=w>Â Â      </span>â”œâ”€â”€<span class=w> </span>sample2_vs_sample1.html
<span class=w>            </span>â”‚<span class=w>Â Â      </span>â””â”€â”€<span class=w> </span>sample2_vs_sample1.tsv
<span class=w>            </span>â”œâ”€â”€<span class=w> </span>sample2
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample2_replicate1.macs2.narrowPeak
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample2_replicate1.macs2.narrowPeak_motif_enrichment
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>ame_results.txt
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>background.fa
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>knownResults
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>knownResults.html
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>knownResults.txt
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>motifFindingParameters.txt
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>seq.autonorm.tsv
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â””â”€â”€<span class=w> </span>target.fa
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample2_replicate1.macs2.unfiltered.narrowPeak
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample2_replicate2.macs2.narrowPeak
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample2_replicate2.macs2.narrowPeak_motif_enrichment
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>ame_results.txt
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>background.fa
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>knownResults
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>knownResults.html
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>knownResults.txt
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>motifFindingParameters.txt
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>seq.autonorm.tsv
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â””â”€â”€<span class=w> </span>target.fa
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample2_replicate2.macs2.unfiltered.narrowPeak
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample2.macs2.consensus.bed
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample2.macs2.consensus.bed_motif_enrichment
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>ame_results.txt
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>background.fa
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>knownResults
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>knownResults.html
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>knownResults.txt
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>motifFindingParameters.txt
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>seq.autonorm.tsv
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”‚<span class=w>Â Â  </span>â””â”€â”€<span class=w> </span>target.fa
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample2.macs2.pooled.narrowPeak
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>sample2.macs2.pooled_summits.bed
<span class=w>            </span>â”‚<span class=w>Â Â  </span>â””â”€â”€<span class=w> </span>sample2.macs2.pooled.unfiltered.narrowPeak
<span class=w>            </span>â”œâ”€â”€<span class=w> </span>sample2.consensus.macs2.peakfiles
<span class=w>            </span>â”œâ”€â”€<span class=w> </span>sample2.replicate.macs2.peakfiles
<span class=w>            </span>â””â”€â”€<span class=w> </span>fixed_width
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>sample1_replicate1.macs2.fixed_width.narrowPeak
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>sample1_replicate2.macs2.fixed_width.narrowPeak
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>sample1.fixed_width.consensus.narrowPeak
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>sample1.renormalized.fixed_width.consensus.narrowPeak
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>sample1.renormalized.fixed_width.consensus.narrowPeak.annotated.gz
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>counts
<span class=w>                </span>â”‚<span class=w>Â Â  </span>â”œâ”€â”€<span class=w> </span>ROI.macs2.reads_counts.tsv
<span class=w>                </span>â”‚<span class=w>Â Â  </span>â””â”€â”€<span class=w> </span>ROI.macs2.tn5sites_counts.tsv
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>sample2_replicate1.macs2.fixed_width.narrowPeak
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>sample2_replicate2.macs2.fixed_width.narrowPeak
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>sample2.fixed_width.consensus.narrowPeak
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>sample2.renormalized.fixed_width.consensus.narrowPeak
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>sample2.renormalized.fixed_width.consensus.narrowPeak.annotated.gz
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>ROI.macs2.bed
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>ROI.macs2.bed.annotated.gz
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>ROI.macs2.bed.annotated.gz.gz
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>ROI.macs2.bed.annotation_distribution
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>ROI.macs2.bed.annotation_summary
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>ROI.macs2.bed.genelist
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>ROI.macs2.gtf
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>ROI.macs2.narrowPeak
<span class=w>                </span>â”œâ”€â”€<span class=w> </span>ROI.macs2.renormalized.narrowPeak
<span class=w>                </span>â””â”€â”€<span class=w> </span>Rplots.pdf
</code></pre></div> <p>Some of the key output files are:</p> <table> <thead> <tr> <th>File</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>*.macs2.narrowPeak</code></td> <td>peak calls from MACS2 filtered by q-value for each samples each replicate</td> </tr> <tr> <td><code>*.macs2.unfiltered.narrowPeak</code></td> <td>peak calls from MACS2 (unfiltered) for each samples each replicate</td> </tr> <tr> <td><code>*.narrowPeak_motif_enrichment/ame_results.txt</code></td> <td>motif enrichment results from AME tool from MEME suite using HOCOMOCO v11 database</td> </tr> <tr> <td><code>*.narrowPeak_motif_enrichment/knownResults.txt</code></td> <td>motif enrichment results using HOMER with HOCOMOCO v11 database</td> </tr> <tr> <td><code>*.macs2.consensus.bed</code></td> <td>consensus peak call between multiple replicates of each sample. <strong>Note:</strong> consensus bed annotations are located in <code>QC/peak_annotations</code></td> </tr> <tr> <td><code>DiffATAC/reads</code></td> <td>folder containing differential open chromatin results: <br> - computated using read counts in MACS2 regions of interest (ROIs) <br> - <code>all_diff_atacs.html</code> HTML report aggregated across all contrasts from <code>contrasts.tsv</code> <br> - <code>all_diff_atacs.tsv</code> DESeq2 results in TSV format aggregated across all contrasts from <code>contrasts.tsv</code> <br> - HTML and TSV file each per contrast in <code>contrasts.tsv</code></td> </tr> <tr> <td><code>DiffATAC/tn5sites</code></td> <td>folder containing differential open chromatin results: <br> - computated using Tn5 nicking site counts in MACS2 regions of interest (ROIs) <br> - <code>all_diff_atacs.html</code> HTML report aggregated across all contrasts from <code>contrasts.tsv</code> <br> - <code>all_diff_atacs.tsv</code> DESeq2 results in TSV format aggregated across all contrasts from <code>contrasts.tsv</code> <br> - HTML and TSV file each per contrast in <code>contrasts.tsv</code></td> </tr> <tr> <td><code>fixed_width</code></td> <td><code>fixed_width</code> can be set in <code>config.yaml</code> to create peaks of a user defined fixed width (default 500bp). This folder contains: <br> - individual replicate <code>*.fixed_width.narrowPeak</code> files <br> - <code>*.renormalized.fixed_width.consensus.narrowPeak</code> per sample; <a href=https://doi.org/10.1038/nmeth.4396><em>Corces et. al.</em></a> method is used for consensus calling; used to generate MACS2 regions of interest (ROI) peaks which are used to generate a reads or Tn5 sites counts matrix for DESeq2 <br> - ROI related files: <code>ROI.macs2.bed</code>, <code>ROI.macs2.bed.annotated.gz</code>, <code>ROI.macs2.annotation_summary</code>, <code>ROI.macs2.annotation_distribution</code></td> </tr> <tr> <td><code>fixed_width/counts/ROI.macs2.read_counts.tsv</code></td> <td>read counts in MACS2 ROIs using featureCounts</td> </tr> <tr> <td><code>fixed_width/counts/ROI.reads_scaled_counts.tsv</code></td> <td><code>ROI.macs2.read_counts.tsv</code> scaled using spike-in scaling factors</td> </tr> <tr> <td><code>fixed_width/counts/ROI.tn5sites_counts.tsv</code></td> <td>Tn5 nicking site counts in MACS2 ROIs using featureCounts</td> </tr> <tr> <td><code>fixed_width/counts/ROI.tn5sites_scaled_counts.tsv</code></td> <td><code>ROI.macs2.tn5sites_counts.tsv</code> scaled using spike-in scaling factors</td> </tr> </tbody> </table> <h3 id=genrich-output-folder>Genrich output folder<a class=headerlink href=#genrich-output-folder title="Permanent link">&para;</a></h3> <p>For a typical 2 sample analysis with 2 replicates each this folder should look like very similar to the MACS2 output structure described above.</p> <h2 id=logs-folder><code>logs</code> folder<a class=headerlink href=#logs-folder title="Permanent link">&para;</a></h2> <p>This directory contains all .err and .out log files generated by SLURM for jobs submitted via Snakemake. Each file follows a consistent naming convention:</p> <div class=highlight><pre><span></span><code>&lt;SLURM_JOB_ID<span class=w> </span>of<span class=w> </span>master/head<span class=w> </span>job&gt;.&lt;SLURM_JOB_ID<span class=w> </span>of<span class=w> </span>child<span class=w> </span>job&gt;.&lt;Snakemake<span class=w> </span>Rule<span class=w> </span>Name&gt;.&lt;<span class=nv>wildcard1_name</span><span class=o>=</span>wildcard1_value,wildcard2_name<span class=o>=</span>wildcard2_value&gt;.&lt;out<span class=w> </span>or<span class=w> </span>err&gt;
</code></pre></div> <p>This structure is particularly useful for troubleshooting and debugging, especially when the SLURM job IDs of failed jobs are known. By examining the corresponding .err or .out files, users can efficiently identify the source of errors within specific Snakemake rules and wildcards.</p> <blockquote> <p>DISCLAIMER: This folder hierarchy is significantly different than v1.0.6 and is subject to change with subsequent versions.</p> </blockquote> </div> </div><script async src="https://www.googletagmanager.com/gtag/js?id=G-D3SL9V30KL"></script> <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-D3SL9V30KL'); // Replace with your tracking ID
</script> </div> </div> </section> </div> <div class=rst-versions role=note aria-label=Versions> <span class=rst-current-version data-toggle=rst-current-version> <span> <a href=https://github.com/CCBR/ASPEN class="fa fa-code-fork" style="color: #fcfcfc"> CCBR/ASPEN</a> </span> <span><a href=../deployment/ style="color: #fcfcfc">&laquo; Previous</a></span> <span><a href=../limitations/ style="color: #fcfcfc">Next &raquo;</a></span> </span> </div> <script src=../js/jquery-3.6.0.min.js></script> <script>var base_url = "..";</script> <script src=../js/theme_extra.js></script> <script src=../js/theme.js></script> <script src=../js/custom.js></script> <script src=../search/main.js></script> <script src=../js/version-select.js></script> <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script> </body> </html> 