<!DOCTYPE html><html class=writer-html5 lang=en> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=author content=CCBR><link rel="shortcut icon" href=../img/favicon.ico><title>Overview of ASPEN - ASPEN</title><link rel=stylesheet href=../css/theme.css><link rel=stylesheet href=../css/theme_extra.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css><link href=../css/custom.css rel=stylesheet><link href=../css/version-select.css rel=stylesheet><script>
        // Current page data
        var mkdocs_page_name = "Overview of ASPEN";
        var mkdocs_page_input_path = "overview.md";
        var mkdocs_page_url = null;
      </script><!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]--><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js></script><script>hljs.highlightAll();</script></head> <body class=wy-body-for-nav role=document> <div class=wy-grid-for-nav> <nav data-toggle=wy-nav-shift class="wy-nav-side stickynav"> <div class=wy-side-scroll> <div class=wy-side-nav-search> <a href=.. class="icon icon-home"> ASPEN </a><div role=search> <form id=rtd-search-form class=wy-form action=../search.html method=get> <input type=text name=q placeholder="Search docs" aria-label="Search docs" title="Type search term here"> </form> </div> </div> <div class="wy-menu wy-menu-vertical" data-spy=affix role=navigation aria-label="Navigation menu"> <ul> <li class=toctree-l1><a class="reference internal" href=..>Background</a> </li> </ul> <ul> <li class=toctree-l1><a href=../introduction/ class="reference internal">Introduction to ATAC-seq</a> </li> </ul> <ul class=current> <li class="toctree-l1 current"><a class="reference internal current" href=#>Overview of ASPEN</a> <ul class=current> <li class=toctree-l2><a class="reference internal" href=#flowchart>Flowchart</a> </li> <li class=toctree-l2><a class="reference internal" href=#data-preprocessing>ğŸ› ï¸ Data Preprocessing</a> <ul> <li class=toctree-l3><a class="reference internal" href=#adapter-trimming>âœ‚ï¸ Adapter Trimming</a> </li> <li class=toctree-l3><a class="reference internal" href=#quality-assessment>ğŸ“Š Quality Assessment</a> </li> </ul> </li> <li class=toctree-l2><a class="reference internal" href=#alignment-and-filtering>ğŸ§¬ Alignment and Filtering</a> <ul> <li class=toctree-l3><a class="reference internal" href=#blacklist-filtering>ğŸš« Blacklist Filtering</a> </li> <li class=toctree-l3><a class="reference internal" href=#read-alignment>ğŸ”— Read Alignment</a> </li> </ul> </li> <li class=toctree-l2><a class="reference internal" href=#peak-calling-and-annotation>ğŸ“ˆ Peak Calling and Annotation</a> <ul> <li class=toctree-l3><a class="reference internal" href=#peak-detection>ğŸ” Peak Detection</a> <ul> <li class=toctree-l4><a class="reference internal" href=#macs2-peak-calling>MACS2 Peak Calling</a> </li> <li class=toctree-l4><a class="reference internal" href=#genrich-peak-calling>Genrich Peak Calling</a> </li> </ul> </li> <li class=toctree-l3><a class="reference internal" href=#consensus-peaks>ğŸ¤ Consensus Peaks</a> </li> <li class=toctree-l3><a class="reference internal" href=#peak-annotation>ğŸ·ï¸ Peak Annotation</a> </li> <li class=toctree-l3><a class="reference internal" href=#regions-of-interest-roi>ğŸ—ºï¸ Regions of Interest (ROI)</a> </li> </ul> </li> <li class=toctree-l2><a class="reference internal" href=#quality-control-metrics>âœ… Quality Control Metrics</a> <ul> <li class=toctree-l3><a class="reference internal" href=#fragment-length-distribution>ğŸ“ Fragment Length Distribution</a> </li> <li class=toctree-l3><a class="reference internal" href=#library-complexity>ğŸ“š Library Complexity</a> </li> <li class=toctree-l3><a class="reference internal" href=#transcription-start-site-tss-enrichment>ğŸ§¬ Transcription Start Site (TSS) Enrichment</a> </li> <li class=toctree-l3><a class="reference internal" href=#fraction-of-reads-in-peaks-frip>ğŸ“Š Fraction of Reads in Peaks (FRiP)</a> </li> </ul> </li> <li class=toctree-l2><a class="reference internal" href=#motif-enrichment-analysis>ğŸ§¬ Motif Enrichment Analysis</a> <ul> <li class=toctree-l3><a class="reference internal" href=#homer-and-ame>ğŸ”‘ HOMER and AME</a> </li> </ul> </li> <li class=toctree-l2><a class="reference internal" href=#comprehensive-reporting>ğŸ“œ Comprehensive Reporting</a> <ul> <li class=toctree-l3><a class="reference internal" href=#multiqc-integration>ğŸ“Š MultiQC Integration</a> </li> </ul> </li> <li class=toctree-l2><a class="reference internal" href=#differential-accessibility-analyses>ğŸ” Differential Accessibility Analyses</a> <ul> <li class=toctree-l3><a class="reference internal" href=#refinement-of-peak-calls-to-fixed-width-peaks>ğŸ› ï¸ Refinement of Peak Calls to Fixed-Width Peaks</a> </li> <li class=toctree-l3><a class="reference internal" href=#definition-of-regions-of-interest-rois>ğŸ“ Definition of Regions of Interest (ROIs)</a> </li> <li class=toctree-l3><a class="reference internal" href=#quantification-of-chromatin-accessibility>ğŸ“Š Quantification of Chromatin Accessibility</a> </li> <li class=toctree-l3><a class="reference internal" href=#differential-accessibility-analysis-using-deseq2>ğŸ“ˆ Differential Accessibility Analysis Using DESeq2</a> <ul> <li class=toctree-l4><a class="reference internal" href=#integration-with-gene-annotations>ğŸ§¬ Integration with Gene Annotations</a> </li> <li class=toctree-l4><a class="reference internal" href=#optional-spike-in-normalization>ğŸ§ª Optional: Spike-In Normalization</a> </li> </ul> </li> <li class=toctree-l3><a class="reference internal" href=#reporting>ğŸ“Š Reporting</a> </li> </ul> </li> </ul> </li> </ul> <ul> <li class=toctree-l1><a href=../deployment/ class="reference internal">Running ASPEN</a> </li> </ul> <ul> <li class=toctree-l1><a href=../outputs/ class="reference internal">ASPEN Output</a> </li> </ul> <ul> <li class=toctree-l1><a href=../limitations/ class="reference internal">Limitations of ASPEN</a> </li> </ul> <ul> <li class=toctree-l1><a href=../communications/ class="reference internal">Communications</a> </li> </ul> <ul> <li class=toctree-l1><a href=../changelog/ class="reference internal">Change Log</a> </li> </ul> <ul> <li class=toctree-l1><a href=../contributing/ class="reference internal">Contributing to ASPEN</a> </li> </ul> </div> </div> </nav> <section data-toggle=wy-nav-shift class=wy-nav-content-wrap> <nav class=wy-nav-top role=navigation aria-label="Mobile navigation menu"> <i data-toggle=wy-nav-top class="fa fa-bars"></i> <a href=..>ASPEN</a> </nav> <div class=wy-nav-content> <div class=rst-content><div role=navigation aria-label="breadcrumbs navigation"> <ul class=wy-breadcrumbs> <li><a href=.. class="icon icon-home" aria-label=Docs></a></li> <li class="breadcrumb-item active">Overview of ASPEN</li> <li class=wy-breadcrumbs-aside> <a href=https://github.com/CCBR/ASPEN/edit/main/docs/overview.md>Edit on CCBR/ASPEN</a> </li> </ul> <hr> </div> <div role=main class=document itemscope=itemscope itemtype=http://schema.org/Article> <div class=section itemprop=articleBody> <h1 id=overview-of-aspen>ğŸŒŸ <strong>Overview of ASPEN</strong><a class=headerlink href=#overview-of-aspen title="Permanent link">&para;</a></h1> <p>To address <a href=../introduction/#challenges-in-atac-seq-data-analysis>these</a> challenges, CCBR developed ASPEN (<strong>A</strong>tac <strong>S</strong>eq <strong>P</strong>ip<strong>E</strong>li<strong>N</strong>e), an automated pipeline tailored for the comprehensive analysis of ATAC-seq data. ASPEN is designed to process paired-end Illumina sequencing data, guiding users from raw data through quality control, alignment, peak calling, and downstream analyses. By integrating a suite of established bioinformatics tools and adhering to best practices, ASPEN ensures robust, reproducible, and high-quality results. For more information on the challenges in ATAC-seq data analysis, refer to the [Challenges in ATAC-seq Data Analysis] section.</p> <h2 id=flowchart><strong>Flowchart</strong><a class=headerlink href=#flowchart title="Permanent link">&para;</a></h2> <p>The flowchart below provides a visual summary of the ASPEN pipeline, illustrating the key steps involved in preprocessing, alignment, peak calling, and downstream analyses.</p> <p><img alt="alt text" src=../assets/images/flowchart.png></p> <h2 id=data-preprocessing>ğŸ› ï¸ <strong>Data Preprocessing</strong><a class=headerlink href=#data-preprocessing title="Permanent link">&para;</a></h2> <h3 id=adapter-trimming>âœ‚ï¸ <strong>Adapter Trimming</strong><a class=headerlink href=#adapter-trimming title="Permanent link">&para;</a></h3> <p>Utilizes CutAdapt to remove adapter sequences from raw reads, ensuring that subsequent analyses are not confounded by extraneous sequences.</p> <h3 id=quality-assessment>ğŸ“Š <strong>Quality Assessment</strong><a class=headerlink href=#quality-assessment title="Permanent link">&para;</a></h3> <p>Employs FastQC for initial quality checks and MultiQC for aggregated reporting, providing comprehensive insights into data quality and highlighting potential issues such as low-quality bases or GC content biases.</p> <h2 id=alignment-and-filtering>ğŸ§¬ <strong>Alignment and Filtering</strong><a class=headerlink href=#alignment-and-filtering title="Permanent link">&para;</a></h2> <h3 id=blacklist-filtering>ğŸš« <strong>Blacklist Filtering</strong><a class=headerlink href=#blacklist-filtering title="Permanent link">&para;</a></h3> <p>Reads aligning to known blacklisted regions and mitochondrial DNA are systematically removed during the preprocessing stage. Blacklisted regions, as defined by ENCODE and other genomic consortia, represent genomic loci prone to artifacts due to their repetitive nature or unusually high signal, which can confound downstream analyses. Similarly, mitochondrial reads, which often constitute a significant proportion of sequencing data, are excluded to prevent skewing results and to ensure computational resources are focused on nuclear chromatin. This filtering step enhances the accuracy and reliability of peak detection by concentrating on biologically meaningful and interpretable regions of the genome.</p> <h3 id=read-alignment>ğŸ”— <strong>Read Alignment</strong><a class=headerlink href=#read-alignment title="Permanent link">&para;</a></h3> <p>Reads are aligned to the reference genome using Bowtie2, a fast and memory-efficient aligner optimized for short-read sequencing data. This step produces several key output files essential for subsequent analyses:</p> <ul> <li><strong><code>filtered.bam</code></strong>: A BAM file with low-quality alignments, reads mapping to blacklisted regions removed, ensuring high-quality data for differential open chromatin analysis.</li> <li><strong><code>qsorted.bam</code></strong>: A quality-sorted BAM file containing all aligned reads, serving as the primary input for Genrich peak calling.</li> <li><strong><code>dedup.bam</code></strong>: A BAM file with PCR duplicates removed, used for advanced downstream analyses such as transcription factor footprinting with TOBIAS.</li> <li><strong><code>tagAlign.gz</code></strong>: A compressed file containing alignment information in a simplified format, specifically prepared for MACS2 peak calling.</li> </ul> <p>This alignment process ensures that only high-confidence reads are retained, providing a robust foundation for accurate and reproducible ATAC-seq data analysis.</p> <h2 id=peak-calling-and-annotation>ğŸ“ˆ <strong>Peak Calling and Annotation</strong><a class=headerlink href=#peak-calling-and-annotation title="Permanent link">&para;</a></h2> <h3 id=peak-detection>ğŸ” <strong>Peak Detection</strong><a class=headerlink href=#peak-detection title="Permanent link">&para;</a></h3> <p>ASPEN employs both MACS2 and Genrich for the identification of regions of open chromatin, ensuring comprehensive detection of regulatory elements.</p> <h4 id=macs2-peak-calling><strong>MACS2 Peak Calling</strong><a class=headerlink href=#macs2-peak-calling title="Permanent link">&para;</a></h4> <p>MACS2 is employed using the default parameters recommended by the ENCODE consortium, ensuring compliance with established best practices. ASPEN produces both unfiltered and q-value filtered peak calls, striking a balance between stringency and the flexibility to examine less stringent results.</p> <h4 id=genrich-peak-calling><strong>Genrich Peak Calling</strong><a class=headerlink href=#genrich-peak-calling title="Permanent link">&para;</a></h4> <p>Genrich is integrated into the pipeline to complement MACS2. This tool is particularly well-suited for ATAC-seq data, as it accounts for the unique characteristics of transposase-accessible regions. By leveraging Genrich, ASPEN ensures that broader regulatory elements, such as enhancers and regions of open chromatin spanning multiple nucleosomes, are accurately identified.</p> <p>By combining the strengths of MACS2 and Genrich, ASPEN delivers a comprehensive and reliable peak detection framework, facilitating downstream analyses and enabling researchers to uncover critical insights into chromatin accessibility and gene regulation.</p> <h3 id=consensus-peaks>ğŸ¤ <strong>Consensus Peaks</strong><a class=headerlink href=#consensus-peaks title="Permanent link">&para;</a></h3> <p>For datasets with multiple replicates, ASPEN employs several strategies to derive consensus peaks across replicates:</p> <ul> <li> <p><strong><code>consensus.bed</code></strong>: This file represents consensus peaks derived using the "Consensus MAX" strategy, as described by <a href=https://doi.org/10.5936/csbj.201401002><em>Yang et al.</em></a>. It identifies overlapping peaks across replicates to define a shared set of regions.</p> </li> <li> <p><strong><code>pooled.narrowPeak</code></strong>: In this approach, reads from all replicates are pooled together, and peak calling is performed on the combined dataset to generate a unified set of "pooled" peaks.</p> </li> <li> <p><strong><code>fixed_width.consensus.narrowPeak</code></strong>: This method calculates consensus peaks by renormalizing p-value scores across replicates, following the approach outlined by <a href=https://doi.org/10.1038/nmeth.4396><em>Corces et al.</em></a>.</p> </li> </ul> <p>Among these methods, the fixed-width consensus peak strategy is recommended for its robustness and reproducibility. The other outputs are provided primarily for exploratory purposes.</p> <h3 id=peak-annotation>ğŸ·ï¸ <strong>Peak Annotation</strong><a class=headerlink href=#peak-annotation title="Permanent link">&para;</a></h3> <p>ASPEN integrates ChIPseeker to perform comprehensive annotation of identified peaks, offering valuable insights into their genomic context and potential regulatory functions. This process involves associating peaks with specific genomic features, such as promoters, enhancers, gene bodies, or intergenic regions. By providing detailed annotations, ASPEN facilitates the interpretation of chromatin accessibility data, enabling researchers to uncover the functional significance of these regions in gene regulation and other biological processes.</p> <h3 id=regions-of-interest-roi>ğŸ—ºï¸ <strong>Regions of Interest (ROI)</strong><a class=headerlink href=#regions-of-interest-roi title="Permanent link">&para;</a></h3> <p>Regions of Interest (ROIs) are generated through a systematic process to ensure consistency and reliability in downstream analyses:</p> <ul> <li>ğŸ§© <strong>Replicate-Level Peaks</strong>: <code>.narrowPeak</code> files from individual replicates are converted into fixed-width peaks, centering on their summits and extending Â±250 bp to achieve a uniform width of 500 bp.</li> <li>ğŸ§¬ <strong>Sample-Level Consensus Peaks</strong>: Fixed-width replicate peak files are combined to generate a consensus set of peaks at the sample level, ensuring reproducibility across replicates.</li> <li>ğŸ”— <strong>Merged ROIs</strong>: Sample-level consensus peak files are merged using the <a href=https://doi.org/10.1038/nmeth.4396>Coerses method</a> to create a comprehensive set of ROIs.</li> </ul> <p>This approach ensures that ROIs represent biologically meaningful and reproducible regions, forming the foundation for robust downstream analyses.</p> <p><img alt="alt text" src=../assets/images/roi.png></p> <h2 id=quality-control-metrics>âœ… <strong>Quality Control Metrics</strong><a class=headerlink href=#quality-control-metrics title="Permanent link">&para;</a></h2> <h3 id=fragment-length-distribution>ğŸ“ <strong>Fragment Length Distribution</strong><a class=headerlink href=#fragment-length-distribution title="Permanent link">&para;</a></h3> <p>ASPEN employs custom scripts to analyze the distribution of fragment lengths within the sequencing data. This analysis provides critical insights into nucleosome positioning and overall sample quality. Characteristic patterns, such as the presence of nucleosome-free regions and distinct mono- or di-nucleosome peaks, serve as indicators of high-quality ATAC-seq data. These patterns reflect the accessibility of chromatin and the degree of nucleosome occupancy, which are essential for interpreting chromatin structure and regulatory dynamics.</p> <h3 id=library-complexity>ğŸ“š <strong>Library Complexity</strong><a class=headerlink href=#library-complexity title="Permanent link">&para;</a></h3> <p>To evaluate the sufficiency of sequencing depth and detect potential biases introduced during PCR amplification, ASPEN utilizes Preseq to estimate library complexity. This metric helps determine whether the sequencing effort is adequate to capture the diversity of the library, ensuring that the data is representative of the underlying chromatin landscape. By identifying potential saturation or over-representation of certain fragments, researchers can assess the reliability of their sequencing results.</p> <h3 id=transcription-start-site-tss-enrichment>ğŸ§¬ <strong>Transcription Start Site (TSS) Enrichment</strong><a class=headerlink href=#transcription-start-site-tss-enrichment title="Permanent link">&para;</a></h3> <p>ASPEN calculates TSS enrichment scores, a widely recognized quality metric for ATAC-seq data. These scores measure the accumulation of sequencing reads around transcription start sites (TSS), which are hallmark regions of open chromatin. High TSS enrichment scores indicate well-prepared libraries with minimal technical artifacts, as they reflect the accessibility of promoter regions and the integrity of the chromatin preparation process.</p> <h3 id=fraction-of-reads-in-peaks-frip>ğŸ“Š <strong>Fraction of Reads in Peaks (FRiP)</strong><a class=headerlink href=#fraction-of-reads-in-peaks-frip title="Permanent link">&para;</a></h3> <p>The Fraction of Reads in Peaks (FRiP) score quantifies the proportion of sequencing reads that fall within identified peaks, serving as a measure of the signal-to-noise ratio in the dataset. Higher FRiP scores indicate datasets with strong, biologically meaningful signals and minimal background noise. Additionally, ASPEN computes the fraction of reads localized to specific genomic features, such as promoters, enhancers, and DNase hypersensitive sites (DHS). These feature-specific FRiP scores provide further insights into the quality and biological relevance of the data.</p> <hr> <h2 id=motif-enrichment-analysis>ğŸ§¬ <strong>Motif Enrichment Analysis</strong><a class=headerlink href=#motif-enrichment-analysis title="Permanent link">&para;</a></h2> <h3 id=homer-and-ame>ğŸ”‘ <strong>HOMER and AME</strong><a class=headerlink href=#homer-and-ame title="Permanent link">&para;</a></h3> <p>ASPEN integrates motif enrichment analysis tools, including HOMER and AME, to identify transcription factor binding motifs within accessible chromatin regions. This analysis provides valuable insights into the regulatory mechanisms governing gene expression. By uncovering enriched motifs, researchers can infer the potential transcription factors driving chromatin accessibility changes and identify key regulators of cellular processes. The combination of HOMER and AME ensures a comprehensive and robust approach to motif discovery, facilitating the interpretation of ATAC-seq data in the context of gene regulation and epigenetic control. HOCOMOCO v11 motifs, which are bundled as resources with ASPEN, are used for both motif enrichment tools.</p> <h2 id=comprehensive-reporting>ğŸ“œ <strong>Comprehensive Reporting</strong><a class=headerlink href=#comprehensive-reporting title="Permanent link">&para;</a></h2> <h3 id=multiqc-integration>ğŸ“Š <strong>MultiQC Integration</strong><a class=headerlink href=#multiqc-integration title="Permanent link">&para;</a></h3> <p>Generates a comprehensive and interactive HTML report that consolidates all quality control metrics, analysis results, and visualizations into a single, user-friendly document. This report is designed to facilitate the interpretation of results, provide clear and actionable insights, and enable seamless sharing of findings with collaborators. By integrating diverse outputs into an organized and visually appealing format, the HTML report ensures that researchers can efficiently explore their data and communicate their discoveries effectively.</p> <h2 id=differential-accessibility-analyses>ğŸ” <strong>Differential Accessibility Analyses</strong><a class=headerlink href=#differential-accessibility-analyses title="Permanent link">&para;</a></h2> <p>ASPEN extends its core functionalities by offering advanced capabilities for differential chromatin accessibility analysis. This feature enables researchers to identify genomic regions exhibiting significant changes in chromatin accessibility under varying experimental conditions. The process encompasses several critical steps, including refining peak calls to fixed-width peaks, defining regions of interest (ROIs), quantifying Tn5 transposase insertion events, performing statistical analyses to detect differential signals, and integrating these findings with ChIP-seq annotations for comprehensive biological interpretation.</p> <h3 id=refinement-of-peak-calls-to-fixed-width-peaks>ğŸ› ï¸ <strong>Refinement of Peak Calls to Fixed-Width Peaks</strong><a class=headerlink href=#refinement-of-peak-calls-to-fixed-width-peaks title="Permanent link">&para;</a></h3> <p>Following the initial peak calling, ASPEN standardizes the identified peaks by centering them on their summits and extending them symmetrically to a uniform width of 500 base pairs (bp). This refinement ensures consistency across datasets and facilitates downstream analyses. The approach of extending peak summits by Â±250 bp is a widely accepted practice in ATAC-seq data analysis, as it focuses on the most accessible regions of chromatin while minimizing variability in peak sizes. This standardization enhances the comparability of results across experimental conditions and replicates.</p> <h3 id=definition-of-regions-of-interest-rois>ğŸ“ <strong>Definition of Regions of Interest (ROIs)</strong><a class=headerlink href=#definition-of-regions-of-interest-rois title="Permanent link">&para;</a></h3> <p>ASPEN processes the fixed-width peak calls for each replicate across all samples to generate a comprehensive union of all identified peaks, referred to as Regions of Interest (ROIs). These ROIs serve as the foundation for subsequent quantification and statistical analyses. The pipeline outputs <code>ROI.bed</code> and <code>ROI.gtf</code> files for each peak caller, which are then utilized for quantifying counts using featureCounts. This systematic approach ensures a robust and consistent framework for differential accessibility analysis, enabling reliable interpretation of the results.</p> <h3 id=quantification-of-chromatin-accessibility>ğŸ“Š <strong>Quantification of Chromatin Accessibility</strong><a class=headerlink href=#quantification-of-chromatin-accessibility title="Permanent link">&para;</a></h3> <p>Once the ROIs are established, ASPEN generates two key count matrices to quantify chromatin accessibility:</p> <ul> <li> <p><strong>Tn5 Nicking Sites Count Matrix</strong>: This matrix quantifies the frequency of Tn5 transposase insertion events at each ROI. The <code>filtered.bam</code> file is used to determine Tn5 insertion sites and count them. Tn5 transposase preferentially inserts into accessible chromatin regions, and the number of insertion events serves as a direct proxy for chromatin accessibility. This metric provides a precise measure of chromatin openness across experimental conditions.</p> </li> <li> <p><strong>Read Counts Matrix</strong>: This matrix records the number of sequencing reads mapped to each ROI. Similar to the Tn5 nicking sites matrix, the <code>filtered.bam</code> file is used for this quantification. While Tn5 nicking sites offer a more direct measure of chromatin accessibility, read counts are included as they are widely utilized in recent publications. Together, these matrices provide a comprehensive view of chromatin accessibility dynamics.</p> </li> </ul> <h3 id=differential-accessibility-analysis-using-deseq2>ğŸ“ˆ <strong>Differential Accessibility Analysis Using DESeq2</strong><a class=headerlink href=#differential-accessibility-analysis-using-deseq2 title="Permanent link">&para;</a></h3> <p>To identify statistically significant differences in chromatin accessibility between experimental conditions, ASPEN employs DESeq2, a widely recognized tool for differential analysis of count data. DESeq2 models the count data to detect changes in accessibility, offering robust statistical inferences even in complex experimental designs. By comparing the count matrices across conditions, DESeq2 identifies ROIs with significant differential accessibility, highlighting regulatory elements that may play critical roles in the biological context of the study.</p> <p>This comprehensive approach to differential accessibility analysis enables researchers to uncover key insights into chromatin dynamics, regulatory mechanisms, and gene expression changes, providing a deeper understanding of the underlying molecular processes.</p> <h4 id=integration-with-gene-annotations>ğŸ§¬ <strong>Integration with Gene Annotations</strong><a class=headerlink href=#integration-with-gene-annotations title="Permanent link">&para;</a></h4> <p>To enhance the biological interpretation of differential accessibility results, ASPEN integrates the findings with peak and gene annotations from ChIPSeeker, offering insights into the regulatory landscape of the genome. This integration allows researchers to identify genes located near differentially accessible peaks, which can be crucial for understanding the functional implications of chromatin accessibility changes. By associating these peaks with nearby genes, scientists can infer potential regulatory relationships and gain a deeper understanding of the underlying molecular mechanisms.</p> <h4 id=optional-spike-in-normalization>ğŸ§ª <strong>Optional: Spike-In Normalization</strong><a class=headerlink href=#optional-spike-in-normalization title="Permanent link">&para;</a></h4> <p>To account for potential global shifts in chromatin accessibilityâ€”particularly in perturbation studies where widespread chromatin compaction or relaxation may occurâ€”ASPEN optionally supports <strong>spike-in normalization</strong>.</p> <p>Spike-in normalization involves the use of exogenous DNA or cells from a different species (e.g., <em>Drosophila melanogaster</em> or <em>E. coli</em>) that are added in equal proportions across all experimental samples prior to lysis and tagmentation. These spike-in reads serve as an internal control to correct for technical variation and global accessibility shifts that may not be captured by traditional normalization strategies.</p> <p>In ASPEN, if spike-in data is present:</p> <ul> <li>Reads are aligned to both the host and spike-in genomes using dual alignment indices.</li> <li>The number of spike-in reads is counted for each sample.</li> <li>A normalization factor is calculated based on spike-in counts and applied to the accessibility read counts from the host genome.</li> </ul> <p>This spike-in-derived scaling factor allows the comparison of chromatin accessibility across conditions even when global chromatin accessibility levels differ (e.g., treatment-induced repression or global decondensation). This method is particularly valuable in experiments involving:</p> <ul> <li>Transcription factor knockdowns/knockouts</li> <li>Chromatin remodeler inhibition</li> <li>Drug-induced chromatin modulation</li> </ul> <p>ASPEN performs spike-in-aware normalization transparently, and reports both raw and normalized counts in the final output matrix for differential analysis. This ensures flexibility in downstream interpretation while preserving the ability to adjust for systemic experimental artifacts.</p> <h3 id=reporting>ğŸ“Š <strong>Reporting</strong><a class=headerlink href=#reporting title="Permanent link">&para;</a></h3> <p>ASPEN enhances differential chromatin accessibility analysis by providing an interactive HTML report generated from DESeq2 results, featuring various visualizations. Additionally, it offers a TSV (tabl-delimited) file with integrated gene annotations, compatible with Microsoft Excel, enabling efficient data manipulation and facilitating the identification of genes near regions with altered accessibility. The Excel file is aggregated accross all different contrasts queried in the project.</p> </div> </div><script async src="https://www.googletagmanager.com/gtag/js?id=G-D3SL9V30KL"></script> <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-D3SL9V30KL'); // Replace with your tracking ID
</script> </div> </div> </section> </div> <div class=rst-versions role=note aria-label=Versions> <span class=rst-current-version data-toggle=rst-current-version> <span> <a href=https://github.com/CCBR/ASPEN class="fa fa-code-fork" style="color: #fcfcfc"> CCBR/ASPEN</a> </span> <span><a href=../introduction/ style="color: #fcfcfc">&laquo; Previous</a></span> <span><a href=../deployment/ style="color: #fcfcfc">Next &raquo;</a></span> </span> </div> <script src=../js/jquery-3.6.0.min.js></script> <script>var base_url = "..";</script> <script src=../js/theme_extra.js></script> <script src=../js/theme.js></script> <script src=../js/custom.js></script> <script src=../search/main.js></script> <script src=../js/version-select.js></script> <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script> </body> </html> 